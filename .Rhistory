carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2),
month=substr(Date,4,6),
year=substr(Date,8,9))
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2),
month=substr(Date,4,6),
year=substr(Date,8,9)) %>% head
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2) %>% as.numeric(),
month=substr(Date,4,6),
year=substr(Date,8,9) %>% as.numeric())
carb$Date
carb$Date %>% unique
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2) %>% as.numeric(),
month=substr(Date,4,6),
year=substr(Date,8,9) %>% as.numeric()) %>%
mutate(year=year+1900)
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2) %>% as.numeric(),
month=substr(Date,4,6),
year=substr(Date,8,9) %>% as.numeric()) %>%
mutate(year=year+1900) %>%
mutate(date=parse_date_time(paste(year,month,day)))
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2) %>% as.numeric(),
month=substr(Date,4,6),
year=substr(Date,8,9) %>% as.numeric()) %>%
mutate(year=year+1900) %>%
mutate(date=parse_date_time(paste(year,month,day), 'ymd'))
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2) %>% as.numeric(),
month=substr(Date,4,6),
year=substr(Date,8,9) %>% as.numeric()) %>%
mutate(year=year+1900) %>%
mutate(date=parse_date_time(paste(year,month,day), 'ymd')) %>%
mutate(test = parse_date_time(Date, '%d-%m-%y'))
carb %>%
rename(year=`*Year`) %>%
mutate(day=substr(Date,1,2) %>% as.numeric(),
month=substr(Date,4,6),
year=substr(Date,8,9) %>% as.numeric()) %>%
mutate(year=year+1900) %>%
# mutate(date=parse_date_time(paste(year,month,day), 'ymd')) %>%
mutate(test = parse_date_time(Date, '%d-%m-%y'))
carb %>%
rename(year=`*Year`) %>%
# mutate(day=substr(Date,1,2) %>% as.numeric(),
#        month=substr(Date,4,6),
#        year=substr(Date,8,9) %>% as.numeric()) %>%
# mutate(year=year+1900) %>%
# mutate(date=parse_date_time(paste(year,month,day), 'ymd')) %>%
mutate(test = parse_date_time(Date, '%d-%m-%y'))
carb <- carb %>%
rename(year=`*Year`) %>%
mutate(date = parse_date_time(Date, '%d-%m-%y')) %>%
select(-Date)
carb %>%
filter(year==1999)
carb %>%
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m))+
geom_point()
carb %>%
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, color=height_cm))+
geom_point()
carb %>% # bad way
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=height_cm))+
geom_raster()
carb %>% # bad way
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=height_cm))+
geom_raster()+
scale_fill_viridis_c()
carb %>% # bad way
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()
carb %>% # bad way
# filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~year)
carb %>% names
carb$plot %>% unique
carb %>% # visualize through time
filter(plot=='A1')
carb %>% # visualize through time
filter(plot=='A1') %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~year)
carb %>% # visualize through time
# filter(plot=='A1') %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~year)
#REALLY VISUALIZE it
library(gganimate)
carb %>% # visualize through time
filter(year=1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~plot)
carb
carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~plot)
carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')
transition_time(year)+
ease_aes('linear')
carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')+
transition_time(year)+
ease_aes('linear')
carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm)))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')+
transition_time(year)+
ease_aes('linear')
#REALLY VISUALIZE it
library(gganimate)
gganimate::gganimate()
?gganimate::gganimate()
carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')+
transition_time(year)+
ease_aes('linear')
carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')
p <- carb %>% # visualize through time
filter(year==1999) %>%
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')
gganimate(p)
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c()+
labs(title='Year: {frame_time}')
gganimate(p)
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c()+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
gganimate(p, "outputs/carbono_plot_heights.mp4")
gganimate(p, "outputs/carbono_plot_heights.gif")
carb$X_m %>% hist
carb$Y_m %>% hist
p <- carb %>% # visualize through time
ggplot(data=., aes(Y_m, X_m, fill=log10(height_cm), frame=year))+
geom_raster()+
scale_fill_viridis_c(option = 'B')+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
gganimate(p, "outputs/carbono_plot_heights.gif")
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
coord_equal()+
scale_fill_viridis_c(option = 'B')+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
gganimate(p, "outputs/carbono_plot_heights.gif")
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
coord_equal()+
scale_fill_viridis_c("Canopy Height [log cm]" option = 'B')+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
gganimate(p, "outputs/carbono_plot_heights.gif")
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
coord_equal()+
scale_fill_viridis_c("Canopy Height [log cm]" option = 'B')+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
gganimate(p, "outputs/carbono_plot_heights.gif")
p
p <- carb %>% # visualize through time
ggplot(data=., aes(X_m, Y_m, fill=log10(height_cm), frame=year))+
geom_raster()+
coord_equal()+
scale_fill_viridis_c("Canopy Height [log cm]", option = 'B')+
facet_wrap(~plot)+
labs(title='Year: {frame_time}')
gganimate(p, "outputs/carbono_plot_heights.gif")
# Spatiotemporal example --------------------------------------------------
nasa
nasa %>% glimpse()
nasa %>%
as_tibble() %>%
ggplot(data=., aes(long,lat))+
geom_raster(aes(fill=ozone))+
coord_equal()+
scale_fill_viridis_c() +
facet_wrap(~month)
nasa %>%
as_tibble() %>%
group_by(lat,long, month) %>%
summarize(u=mean(temperature,na.rm=T)) %>%
ggplot(data=., aes(long,lat))+
geom_raster(aes(fill=u))+
coord_equal()+
scale_fill_viridis_c() +
facet_wrap(~month)
nasa %>%
as_tibble() %>%
group_by(lat,long, month) %>%
summarize(u=mean(temperature,na.rm=T)) %>%
ungroup() %>%
mutate(tempC = u - 273.15) %>%
ggplot(data=., aes(long,lat))+
geom_raster(aes(fill=tempC))+
coord_equal()+
scale_fill_viridis_c() +
facet_wrap(~month)
nasa %>%
as_tibble() %>%
group_by(lat,long, year,month) %>%
# summarize(u=mean(temperature,na.rm=T)) %>%
# ungroup() %>%
mutate(tempC = temperature - 273.15) %>%
mutate(hemi = cut(lat,breaks = c(-Inf,0,Inf),labels = c("SH","NH"))) %>%
group_by(hemi,year,month) %>%
summarize(u=mean(tempC,na.rm=T)) %>%
ungroup() %>%
mutate(date=parse_date_time(paste(year,month,1),'ymd')) %>%
ggplot(data=., aes(date,u,color=hemi))+
geom_line()+
scale_fill_viridis_c()
data()
UKDriverDeaths
seals
# Seals -------------------------------------------------------------------
data("seals")
seals %>% glimpse
geom_segment()
?geom_segment()
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
borders("state")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_cartesian()
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_cartesian()+
borders("state")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("state")
borders("state")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("world")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("world")
?borders
map('usa')
map(database = 'usa')
map(database = 'usa', regions = "west")
map(database = 'usa', regions = "state:west")
map(database = 'usa', regions = "california:west")
?map
map(database = 'usa', regions = "california:north")
map(database = 'usa', regions = "california")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("california")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("California")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("USA")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("usa")
ggplot(seals, aes(long, lat)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("usa")+
scale_x_continuous(limits = c(-150,-120))
seals
seals %>% select(lat,long) %>% dist
seal %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2))
seals %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2))
seals %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2)) %>%
ggplot(., aes(long, lat, color=distance)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("usa")+
scale_x_continuous(limits = c(-150,-120))
seals %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2)) %>%
ggplot(., aes(long, lat, color=distance)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("usa")+
scale_x_continuous(limits = c(-150,-120))+
theme_grey()
seals %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2)) %>%
ggplot(., aes(long, lat, color=distance)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("usa")+
scale_x_continuous(limits = c(-150,-120))+
theme_dark()
seals %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2)) %>%
ggplot(., aes(long, lat, color=distance)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm"))) +
coord_equal()+
borders("usa")+
scale_x_continuous(limits = c(-150,-120))+
scale_color_viridis_c()+
theme_dark()
seals %>%
mutate(distance=sqrt(delta_long**2 + delta_lat**2)) %>%
ggplot(., aes(long, lat, color=distance)) +
geom_segment(aes(xend = long + delta_long, yend = lat + delta_lat),
arrow = arrow(length = unit(0.1,"cm")),lwd=2) +
coord_equal()+
borders("usa")+
scale_x_continuous(limits = c(-150,-120))+
scale_color_viridis_c()+
theme_dark()
storms
# storms ------------------------------------------------------------------
names(storms)
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("usa")
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("world")
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("world")+
scale_x_continuous(limits=c(-120,0))+
scale_y_continuous(limits = c(0,55))
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("world")+
scale_x_continuous(limits=c(-120,0))+
scale_y_continuous(limits = c(0,55))+
borders('world')
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("world")+
scale_x_continuous(limits=c(-120,0))+
scale_y_continuous(limits = c(-10,55))+
borders('world')
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("world")+
scale_x_continuous(limits=c(-120,0))+
scale_y_continuous(limits = c(-10,55))+
borders('world', fill = "black")
storms %>%
ggplot(data=., aes(long,lat,size=category))+geom_point()+
borders("world")+
scale_x_continuous(limits=c(-120,0))+
scale_y_continuous(limits = c(-10,55))+
borders('world', fill = "brown")
# bad!
storms %>%
ggplot(data=., aes(long,lat,size=category))+
borders("world")+
geom_point()+
scale_x_continuous(limits=c(-120,0))+
scale_y_continuous(limits = c(-10,55))
storms
# bad!
storms %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("world")+
geom_point()+
# scale_x_continuous(limits=c(-120,0))+
# scale_y_continuous(limits = c(-10,55))
# SPATIAL METHODS + TIDYVERSE ---------------------------------------------
install.packages("rgdal","")
# bad!
storms %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("world")+
geom_point()+
scale_color_viridis_c()
# bad!
storms %>%
arrange(wind) %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("world")+
geom_point()+
scale_color_viridis_c()
# bad!
storms %>%
arrange(wind) %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("florida")+
geom_point()+
scale_color_viridis_c()+
scale_x_continuous(limits=c(-130,0))+
scale_y_continuous(limits = c(-10,55))
# bad!
storms %>%
arrange(wind) %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("state")+
geom_point()+
scale_color_viridis_c()+
scale_x_continuous(limits=c(-130,0))+
scale_y_continuous(limits = c(-10,55))
# bad!
storms %>%
arrange(wind) %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("mexico")+
geom_point()+
scale_color_viridis_c()+
scale_x_continuous(limits=c(-130,0))+
scale_y_continuous(limits = c(-10,55))
# bad!
storms %>%
arrange(wind) %>%
ggplot(data=., aes(long,lat,size=category,color=wind))+
borders("coast")+
geom_point()+
scale_color_viridis_c()+
scale_x_continuous(limits=c(-130,0))+
scale_y_continuous(limits = c(-10,55))
?borders
